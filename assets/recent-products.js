class RecentProducts extends HTMLElement{constructor(){super()}connectedCallback(){this.current_width=window.innerWidth,this.main_grid=this.querySelector(".recent-products--grid"),this.spinner=this.querySelector(".recent-products--spinner"),this.storage=JSON.parse(localStorage.getItem(theme.local_storage.recent_products)),this.storage?this.load():this.style.display="none"}load(){var e=this.storage.map(e=>this.renderProductItem(e));Promise.allSettled(e).then(()=>{this.main_grid.removeAttribute("style"),this.spinner.style.display="none",this.formatProducts()})}async renderProductItem(e){const t=await fetch(theme.urls.root+`/products/${e}?view=ajax-item`);t.ok&&(e=await t.text(),e=theme.utils.parseHtml(e,".product--root"),this.main_grid.prepend(e))}formatProducts(){this.resizeListeners(),this.matchImageHeights(),theme.settings.hover_image_enabled&&this.hoverImagesLoaded(),theme.settings.quick_add&&theme.off_canvas&&theme.off_canvas.reset()}resizeListeners(){window.on("resize.RecentProducts",theme.utils.debounce(100,()=>{this.current_width!==window.innerWidth&&(this.matchImageHeights(),this.current_width=window.innerWidth)}))}matchImageHeights(){theme.utils.matchImageHeights(this.main_grid,this.querySelectorAll(".product--root"),".product--image-wrapper")}hoverImagesLoaded(){this.main_grid.querySelectorAll(".product--hover-image").forEach(t=>{theme.utils.imagesLoaded(t,()=>{const e=t.closest('[data-hover-image="true"]');e&&e.setAttribute("data-hover-image","loaded")})})}}customElements.define("recent-products-root",RecentProducts);